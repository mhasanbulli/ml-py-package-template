#!/bin/bash

# Pre-push hook to run linting and basic validation
# Install with: cp hooks/pre-push .git/hooks/pre-push && chmod +x .git/hooks/pre-push

set -e

echo "ğŸ” Running pre-push checks..."

# Check if we're in a git repository
if ! git rev-parse --git-dir > /dev/null 2>&1; then
    echo "âŒ Not in a git repository"
    exit 1
fi

# Run ruff linting
echo "ğŸ”§ Running ruff linting..."
if command -v uv >/dev/null 2>&1; then
    uv run ruff check .
    uv run ruff format --check .
else
    echo "âš ï¸  uv not found, skipping ruff checks"
fi

# Run type checking
echo "ğŸ” Running type checking..."
if command -v uv >/dev/null 2>&1; then
    uv run pyright
else
    echo "âš ï¸  uv not found, skipping type checking"
fi

# Run tests
echo "ğŸ§ª Running tests..."
if command -v uv >/dev/null 2>&1; then
    uv run pytest
else
    echo "âš ï¸  uv not found, skipping tests"
fi

echo "âœ… All pre-push checks passed!"
